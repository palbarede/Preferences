# ==================
# tmux configuration
# ==================
#
# <<Perche' screen e' anni '90.>>
#	-- Anonimo
#
# Key bindings:
# s => choose-tree => Permette di scegliere una window/pane di una sessione
# w => choose-window => Permette di scegliere una window di questa sessione

################
# MISC OPTIONS #
################

# set TERM for 256 colors
set -g default-terminal "screen-256color"

# enable utf8 globally
set-window-option -g utf8 on
set -g status-utf8 on

# turn off automatic renaming
# 18/09/2012 - osx ML fa conflitto con | less, lo disattivo.
set-window-option -g automatic-rename off

# quando si chiude l'ultima finestra e ci sono ancora sessioni aperte, passa alla prima di esse.
set -g detach-on-destroy off

# don't like the bell (?)
set -g bell-action current
# show tmux messages for 3000 ms
set -g display-time 1000

# display-panes colors
set -g display-panes-active-colour colour214
set -g display-panes-colour colour112

# emacs keys, che e' meglio.
set-window-option -g mode-keys vi
set -g status-keys emacs

# enable wm window titles
set -g set-titles on

# wm window title string (uses statusbar variables)
set -g set-titles-string "win:#I #W '#T'"

# Gli id di window e pane partono da 1 e non da 0 (1 e' piu' comodo da premere)
set -g base-index 1

# pane border
set-option -g pane-border-fg colour235 #base02
set-option -g pane-active-border-fg colour240 #base01

# pane number display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange

# clock
set-window-option -g clock-mode-colour colour64 #green

set-option -g message-bg default
set-option -g message-fg colour166 #orange

# disabilita il mouse (per scrolling, selezione pane e co)
# (Funziona solo su linux ed e' una merda perche' poi non puoi selezionare con
# il mouse per il cut/paste)
setw -g mode-mouse off
set -g mouse-select-pane off

##############
# STATUS BAR #
##############

# left status bar
set -g status-left '#[fg=blue,bold] #S#[default,fg=white][#[fg=yellow]#I.#P#[fg=white]]#[fg=black,bold]@#[fg=red]#h#[default]'
set -g status-left-length 80

# right status bar
set -g status-right "#[fg=colour024]%H:%M %d-%h-%Y#[default]"
set -g status-right-length 80

# status bar colors (qui sembra che i 256 colors non funzionino...)
set -g status-bg colour235
set -g status-fg colour250

# center align the window list
set -g status-justify centre

# default statusbar colors
set-option -g status-bg colour235 #base02
set-option -g status-fg colour136 #yellow
set-option -g status-attr default

# default window title colors
setw -g window-status-bg default
setw -g window-status-fg colour245

# active window title colors
setw -g window-status-current-bg colour23
setw -g window-status-current-fg colour214

# --- colori nuovi per status bar ---
# 10 aprile 2013
# uso lo stesso colore dello sfondo del term per lo sfondo della status bar
set -g status-bg default
set -g status-fg colour236

setw -g window-status-format '#[fg=colour88,bg=colour238] #I #[fg=colour233,bg=colour23] #W#F '
setw -g window-status-current-format '#[fg=colour231,bg=colour32,bold] #I #[fg=colour233,bg=colour76] #W#F '

################
# KEY BINDINGS #
################

# split current window
bind 'S' split-window

# alt+left: previous window
# alt+right: next window
# (Su OS X Ã¨ Ctrl-Shift-<left|right>, se hai attivato ALT=META nelle opzioni di Terminal.app)
bind -n M-left previous-window
bind -n M-right next-window

# F8: previous window
# F9: next window
# bind -n F8 previous-window
# bind -n F9 next-window

# set command prefix from C-b to C-a
# NOTE: there was a problem with tmux (maybe it's by design) for which you
# can't use a command prefix like "`" because it could get triggered by pasted
# text. :(
unbind C-b
set -g prefix C-a
# allow sending of "real" C-a for readline and nested tmux sessions (i.e. you can
# press C-a C-a to send a real C-a)
bind a send-prefix

# set window title
unbind A
bind A command-prompt "rename-window %%"

# Vertical and horizontal window splitting
bind | split-window -h
bind - split-window -v

# pane movement
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# reload config
bind r source-file ~/.tmux.conf \; display "tmux configuration reloaded"

# monitor activity
bind m setw monitor-activity

###########################
# OS BASED CUSTOMIZATIONS #
###########################

# If tmux is started from an ssh connection rebind the command key from C-a to C-f
if '[ ! -z "$SSH_CONNECTION" ]' 'unbind C-a ; set -g prefix C-f ; bind C-f send-prefix'

# Pass the "copy buffer" from copy mode to the "graphical" clipboard buffer (X11 or Darwin)
if '[[ $OSTYPE == linux* ]]' 'bind y run-shell "tmux save-buffer - | xclip -in -selection clipboard -d :0" \; display-message "tmux bufffer copied into clipboard!"'
if '[[ $OSTYPE == darwin* ]]' 'bind y run-shell "tmux save-buffer - | reattach-to-user-namespace pbcopy" \; display-message "tmux buffer copied into clipboard!"'

# solarized-dark
# source /Users/sand/dev/others/tmux-colors-solarized/tmuxcolors-dark.conf

# Local settings
# for example to use reattach-to-user-namespace and fix tmux+Terminal.app
# problems on OS X:
# if '[[ $OSTYPE == darwin* ]]' 'set-option -g default-command "reattach-to-user-namespace -l /usr/local/bin/zsh"'

if '[ -e ~/.tmux.local ]' 'source ~/.tmux.local'
if '[ -e ~/Preferences/tmux1.6.conf ]' 'source ~/Preferences/tmux1.6.conf'

# vim: ft=tmux
